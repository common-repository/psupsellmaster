var psupsellmaster_chart=null;jQuery(document).ready(function(s){s(".psupsellmaster_date").each(function(){new Pikaday({field:s(this).get(0),format:"YYYY/MM/DD"})}),s("#psupsellmaster_btn_this_month").on("click",function(){let e=moment().startOf("month").format("YYYY/MM/DD"),t=moment().endOf("month").format("YYYY/MM/DD");s("#psupsellmaster_date_from").val(e).trigger("change"),s("#psupsellmaster_date_to").val(t).trigger("change")}),s("#psupsellmaster_btn_last_month").on("click",function(){let e=moment().subtract(1,"months").startOf("month").format("YYYY/MM/DD"),t=moment().subtract(1,"months").endOf("month").format("YYYY/MM/DD");s("#psupsellmaster_date_from").val(e).trigger("change"),s("#psupsellmaster_date_to").val(t).trigger("change")}),s("#psupsellmaster_btn_this_year").on("click",function(){let e=moment().startOf("year").format("YYYY/MM/DD"),t=moment().endOf("year").format("YYYY/MM/DD");s("#psupsellmaster_date_from").val(e).trigger("change"),s("#psupsellmaster_date_to").val(t).trigger("change")}),s("#psupsellmaster_btn_last_year").on("click",function(){let e=moment().subtract(1,"years").startOf("year").format("YYYY/MM/DD"),t=moment().subtract(1,"years").endOf("year").format("YYYY/MM/DD");s("#psupsellmaster_date_from").val(e).trigger("change"),s("#psupsellmaster_date_to").val(t).trigger("change")}),s("#psupsellmaster_btn_last_week").on("click",function(){let e=moment().subtract(1,"week").startOf("week").format("YYYY/MM/DD"),t=moment().subtract(1,"week").endOf("week").format("YYYY/MM/DD");s("#psupsellmaster_date_from").val(e).trigger("change"),s("#psupsellmaster_date_to").val(t).trigger("change")}),s("#psupsellmaster_btn_reset").on("click",function(){s("#psupsellmaster_date_from").val("").trigger("change"),s("#psupsellmaster_date_to").val("").trigger("change")}),s("#psupsellmaster_btn_apply_filters").on("click",function(){t=(e=s(this)).closest("#psupsellmaster_filters"),a={base:{},upsell:{}},t.find(".psupsellmaster-field-custom-taxonomy").each(function(){var e,t,l,r;r=(e=s(this)).val(),l=e.data("target-type"),t=e.data("taxonomy"),"base"===l?a.base[t]=r:a.upsell[t]=r}),s('#psupsellmaster_upsells_filter input[type="search"]').val(s("#psupsellmaster_search").val()).trigger("search");var e,t,a,l={bp:s("#psupsellmaster_base_products").val(),bc:s("#psupsellmaster_base_categories").val(),bt:s("#psupsellmaster_base_tags").val(),up:s("#psupsellmaster_upsell_products").val(),uc:s("#psupsellmaster_upsell_categories").val(),ut:s("#psupsellmaster_upsell_tags").val(),rp:s("#psupsellmaster_related_products").val(),cu:s("#psupsellmaster_customers").val(),loc:s("#psupsellmaster_location").val(),typ:s("#psupsellmaster_source").val(),prf:s("#psupsellmaster_price_from").val(),prt:s("#psupsellmaster_price_to").val(),saf:s("#psupsellmaster_sale_from").val(),sat:s("#psupsellmaster_sale_to").val(),dtf:(""+s("#psupsellmaster_date_from").val()).replace(/\//g,"-"),dtt:(""+s("#psupsellmaster_date_to").val()).replace(/\//g,"-"),custom_taxonomies:a},r=PsUpsellmaster.attributes.ajax.url+"?nonce="+PsUpsellmaster.attributes.ajax.nonce+"&action=psupsellmaster_admin_ajax_get_upsells&f="+encodeURIComponent(JSON.stringify(l));s("#psupsellmaster_upsells").DataTable().ajax.url(r).load(),s("#psupsellmaster_summary_details_filters_text_1").show(),s("#psupsellmaster_summary_details_filters_text_2").hide();var p="",m=l.dtf.length>0?moment(l.dtf+" 00:00:00","YYYY-MM-DD").format("MMMM Do"):"",u=l.dtt.length>0?moment(l.dtt+" 00:00:00","YYYY-MM-DD").format("MMMM Do"):"";if(m.length>0&&(p+=" from "+m),u.length>0&&(p+=" to "+u),m.length>0&&u.length>0){var o=moment(l.dtf,"YYYY-MM-DD");p+=" ("+(parseInt(moment(l.dtt,"YYYY-MM-DD").diff(o,"days"))+1)+" days)"}s("#psupsellmaster_summary_details_date_period").html(p)}),s("#psupsellmaster_search").on("keyup",function(e){s('#psupsellmaster_upsells_filter input[type="search"]').val(s(this).val()).trigger("change")}),s("#psupsellmaster_search").on("search",function(e){s('#psupsellmaster_upsells_filter input[type="search"]').val(s(this).val()).trigger("search")}),s(".psupsellmaster_expand_filters_content").on("click",function(){s("#psupsellmaster_filters_content").hasClass("psupsellmaster_hidden")?s("#psupsellmaster_filters_content").removeClass("psupsellmaster_hidden"):s("#psupsellmaster_filters_content").addClass("psupsellmaster_hidden")})}),function(s){var e;(e={attributes:{},events:{onClickBtnResetFilters:function e(t){PsUpsellmaster.select2.functions.clearAll(),s(".psupsellmaster_price").val("").trigger("change"),s("#psupsellmaster_btn_reset").trigger("click"),s("#psupsellmaster_upsells").DataTable().ajax.url(PsUpsellmaster.attributes.ajax.url+"?nonce="+PsUpsellmaster.attributes.ajax.nonce+"&action=psupsellmaster_admin_ajax_get_upsells").load(),s("#psupsellmaster_summary_details_filters_text_1").hide(),s("#psupsellmaster_summary_details_filters_text_2").show(),s('#psupsellmaster_upsells_filter input[type="search"]').val("").trigger("search"),s("#psupsellmaster_search").val("").trigger("search")},onDataTableCreatedCell:function e(t){s(t).addClass("psupsellmaster-datatable-col")},onDataTableCreatedRow:function e(t){s(t).addClass("psupsellmaster-datatable-row")},onDocumentReady:function s(){e.functions.startDataTables(),e.functions.startTooltips()}},functions:{attachTooltips:function e(t){var a;0!==(a=s(t=t||".psupsellmaster-help-tip")).length&&a.tooltip({content:function(){return s(this).prop("title")},tooltipClass:"psupsellmaster-ui-tooltip",position:{my:"center top",at:"center bottom+10",collision:"flipfit"},hide:{duration:200},show:{duration:200}})},init:function s(){e.functions.registerAttributes(),e.functions.registerEvents()},registerAttributes:function s(){"undefined"!=typeof psupsellmaster_admin_data_results&&(e.data=psupsellmaster_admin_data_results)},registerEvents:function t(){s(e.events.onDocumentReady),s(document).on("click","#psupsellmaster_btn_reset_filters",e.events.onClickBtnResetFilters)},startDataTables:function t(){var a={dom:"Bfliptip",serverSide:!0,filter:!0,paginate:!0,pagingType:"full_numbers",pageLength:100,lengthMenu:[[10,25,50,100,250,1e3],[10,25,50,100,250,1e3],],displayLength:100,oLanguage:{sLengthMenu:e.data.texts.datatable_length},order:[[0,"desc"]],buttons:[{className:"button",extend:"copyHtml5"},{className:"button",extend:"print"},{className:"button",extend:"csvHtml5"},{className:"button",extend:"excelHtml5"},],columnDefs:[{targets:0,className:"dt-body-right"},{targets:1,className:"dt-body-right"},{targets:2,className:"dt-body-left",width:"15%"},{targets:3,className:"dt-body-left",width:"15%"},{targets:4,className:"dt-body-left"},{targets:5,className:"dt-body-left"},{targets:6,className:"dt-body-left"},{targets:7,className:"dt-body-left"},{targets:8,className:"dt-body-left"},{targets:9,className:"dt-body-right"},{targets:10,className:"dt-body-left",orderable:!1,width:"25%"},{targets:11,className:"dt-body-right"},{createdCell:e.events.onDataTableCreatedCell,targets:"_all"},],createdRow:e.events.onDataTableCreatedRow,initComplete:function(){s(".psupsellmaster-datatable-wrapper .buttons-copy").html('<i class="fa fa-copy"></i>&nbsp;'+psupsellmaster_admin_data_results.texts.datatable_btn_copy),s(".psupsellmaster-datatable-wrapper .buttons-csv").html('<i class="fa fa-file-csv"></i>&nbsp;'+psupsellmaster_admin_data_results.texts.datatable_btn_csv),s(".psupsellmaster-datatable-wrapper .buttons-excel").html('<i class="fa fa-file-excel"></i>&nbsp;'+psupsellmaster_admin_data_results.texts.datatable_btn_excel),s(".psupsellmaster-datatable-wrapper .buttons-print").html('<i class="fa fa-print"></i>&nbsp;'+psupsellmaster_admin_data_results.texts.datatable_btn_print)},drawCallback:function(e){s("#psupsellmaster_upsells td div.psupsellmaster_upsells_edit_view_container").each(function(e){s(this).closest(".psupsellmaster_upsells_base_product").hover(function(){s(this).find(".psupsellmaster_upsells_edit_view").show()},function(){s(this).find(".psupsellmaster_upsells_edit_view").hide()})}),s("#psupsellmaster_upsells").css({width:"100%"})},ajax:{url:PsUpsellmaster.attributes.ajax.url+"?nonce="+PsUpsellmaster.attributes.ajax.nonce+"&action=psupsellmaster_admin_ajax_get_upsells"}};s("#psupsellmaster_upsells").on("xhr.dt",function(e,t,a,l){if(!a)return;if(psupsellmaster_chart)try{psupsellmaster_chart.destroy()}catch(r){}s("#psupsellmaster-summary-chart").html("");let p={type:"line",data:{labels:[],datasets:[{label:"Chart: Daily",backgroundColor:"rgb(255, 99, 132)",borderColor:"rgb(255, 99, 132)",data:[]}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{ticks:{callback:function(s,e,t){return a.currency_symbol+s.toLocaleString()}}}}}};for(var m,u,o,b=a.chart_data.length,n=0;n<b;n++)p.data.labels.push(a.chart_data[n][1]),p.data.datasets[0].data.push(a.chart_data[n][0]);psupsellmaster_chart=new Chart(document.getElementById("psupsellmaster-summary-chart"),p),s(".psupsellmaster-summary-table-body .psupsellmaster-stats-table-row-label").html(""),s(".psupsellmaster-summary-table-body .psupsellmaster-stats-table-row-value").html("0&#37;"),s(".psupsellmaster-results-summary").eq(0).find(".psupsellmaster-summary-total-value").html(a.sum_sales_value),s(".psupsellmaster-stats-table-details-upsells .psupsellmaster-summary-table-body .psupsellmaster-summary-table-row").eq(0).find(".psupsellmaster-stats-table-row-value").html(a.sum_sales_value),s(".psupsellmaster-stats-table-details-upsells .psupsellmaster-summary-table-body .psupsellmaster-summary-table-row").eq(1).find(".psupsellmaster-stats-table-row-value").html(a.recordsFiltered),s(".psupsellmaster-stats-table-details-upsells .psupsellmaster-summary-table-body .psupsellmaster-summary-table-row").eq(2).find(".psupsellmaster-stats-table-row-value").html(a.countd_upsell_id),s(".psupsellmaster-stats-table-details-upsells .psupsellmaster-summary-table-body .psupsellmaster-summary-table-row").eq(3).find(".psupsellmaster-stats-table-row-value").html(a.avg_upsells_per_product),s(".psupsellmaster-stats-table-details-upsells .psupsellmaster-summary-table-body .psupsellmaster-summary-table-row").eq(4).find(".psupsellmaster-stats-table-row-value").html(a.range_sales_value),s(".psupsellmaster-stats-table-details-upsells .psupsellmaster-summary-table-body .psupsellmaster-summary-table-row").eq(5).find(".psupsellmaster-stats-table-row-value").html(a.avg_sales_value),s(".psupsellmaster-stats-table-details-upsells .psupsellmaster-summary-table-body .psupsellmaster-summary-table-row").eq(6).find(".psupsellmaster-stats-table-row-value").html(a.days_created),s(".psupsellmaster-stats-table-details-upsells .psupsellmaster-summary-table-footer .psupsellmaster-summary-table-row").eq(0).find(".psupsellmaster-stats-table-row-value").html(a.avg_sales_value_per_day),s(".psupsellmaster-stats-table-details-products .psupsellmaster-summary-table-body .psupsellmaster-summary-table-row").eq(0).find(".psupsellmaster-stats-table-row-value").html(a.sum_sales_value),s(".psupsellmaster-stats-table-details-products .psupsellmaster-summary-table-body .psupsellmaster-summary-table-row").eq(1).find(".psupsellmaster-stats-table-row-value").html(a.countd_base_product_id),s(".psupsellmaster-stats-table-details-products .psupsellmaster-summary-table-footer .psupsellmaster-summary-table-row").eq(0).find(".psupsellmaster-stats-table-row-value").html(a.avg_sales_value_per_base_product),s(".psupsellmaster-stats-table-details-orders .psupsellmaster-summary-table-body .psupsellmaster-summary-table-row").eq(0).find(".psupsellmaster-stats-table-row-value").html(a.countd_payment_id),s(".psupsellmaster-stats-table-details-orders .psupsellmaster-summary-table-body .psupsellmaster-summary-table-row").eq(1).find(".psupsellmaster-stats-table-row-value").html(a.sum_order_value_excl_upsells),s(".psupsellmaster-stats-table-details-orders .psupsellmaster-summary-table-body .psupsellmaster-summary-table-row").eq(2).find(".psupsellmaster-stats-table-row-value").html(a.sum_sales_value),s(".psupsellmaster-stats-table-details-orders .psupsellmaster-summary-table-body .psupsellmaster-summary-table-row").eq(3).find(".psupsellmaster-stats-table-row-value").html(a.sum_order_value_incl_upsells),s(".psupsellmaster-stats-table-details-orders .psupsellmaster-summary-table-body .psupsellmaster-summary-table-row").eq(4).find(".psupsellmaster-stats-table-row-value").html(a.avg_order_value_excl_upsells),s(".psupsellmaster-stats-table-details-orders .psupsellmaster-summary-table-body .psupsellmaster-summary-table-row").eq(5).find(".psupsellmaster-stats-table-row-value").html(a.avg_sales_value_per_order),s(".psupsellmaster-stats-table-details-orders .psupsellmaster-summary-table-footer .psupsellmaster-summary-table-row").eq(0).find(".psupsellmaster-stats-table-row-value").html(a.avg_order_value_incl_upsells),s(".psupsellmaster-stats-table-details-customers .psupsellmaster-summary-table-body .psupsellmaster-summary-table-row").eq(0).find(".psupsellmaster-stats-table-row-value").html(a.sum_sales_value),s(".psupsellmaster-stats-table-details-customers .psupsellmaster-summary-table-body .psupsellmaster-summary-table-row").eq(1).find(".psupsellmaster-stats-table-row-value").html(a.countd_customer_id),s(".psupsellmaster-stats-table-details-customers .psupsellmaster-summary-table-footer .psupsellmaster-summary-table-row").eq(0).find(".psupsellmaster-stats-table-row-value").html(a.avg_sales_value_per_customer);for(var i=a.top_upsells.length,n=0;n<i;n++)m=a.top_upsells[n],(u=s(".psupsellmaster-stats-table-top-upsells .psupsellmaster-summary-table-body .psupsellmaster-summary-table-row").eq(n)).find(".psupsellmaster-stats-table-row-label").html('<a href="'+m[4]+'" target="_blank">'+m[3]+" ("+m[1]+")</a>"),u.find(".psupsellmaster-stats-table-row-value").html(m[2]+"&#37;");s(".psupsellmaster-stats-table-top-upsells .psupsellmaster-summary-table-footer .psupsellmaster-summary-table-row").eq(0).find(".psupsellmaster-stats-table-row-label").html("&nbsp;("+a.top_upsells_other_sum+")"),s(".psupsellmaster-stats-table-top-upsells .psupsellmaster-summary-table-footer .psupsellmaster-summary-table-row").eq(0).find(".psupsellmaster-stats-table-row-value").html(a.top_upsells_other+"&#37;"),s(".psupsellmaster-stats-table-top-upsells .psupsellmaster-summary-table-footer .psupsellmaster-summary-table-row").eq(1).find(".psupsellmaster-stats-table-row-label").html("&nbsp;("+a.sum_sales_value+")");for(var d=a.top_base.length,n=0;n<d;n++)m=a.top_base[n],(u=s(".psupsellmaster-stats-table-top-base-products .psupsellmaster-summary-table-body .psupsellmaster-summary-table-row").eq(n)).find(".psupsellmaster-stats-table-row-label").html('<a href="'+m[4]+'" target="_blank">'+m[3]+" ("+m[1]+")</a>"),u.find(".psupsellmaster-stats-table-row-value").html(m[2]+"&#37;");s(".psupsellmaster-stats-table-top-base-products .psupsellmaster-summary-table-footer .psupsellmaster-summary-table-row").eq(0).find(".psupsellmaster-stats-table-row-label").html("&nbsp;("+a.top_base_other_sum+")"),s(".psupsellmaster-stats-table-top-base-products .psupsellmaster-summary-table-footer .psupsellmaster-summary-table-row").eq(0).find(".psupsellmaster-stats-table-row-value").html(a.top_base_other+"&#37;"),s(".psupsellmaster-stats-table-top-base-products .psupsellmaster-summary-table-footer .psupsellmaster-summary-table-row").eq(1).find(".psupsellmaster-stats-table-row-label").html("&nbsp;("+a.sum_sales_value+")");for(var c=a.top_customers.length,n=0;n<c;n++)m=a.top_customers[n],(u=s(".psupsellmaster-stats-table-top-customers .psupsellmaster-summary-table-body .psupsellmaster-summary-table-row").eq(n)).find(".psupsellmaster-stats-table-row-label").html('<a href="'+m[4]+'" target="_blank">'+m[3]+" ("+m[1]+")</a>"),u.find(".psupsellmaster-stats-table-row-value").html(m[2]+"&#37;");s(".psupsellmaster-stats-table-top-customers .psupsellmaster-summary-table-footer .psupsellmaster-summary-table-row").eq(0).find(".psupsellmaster-stats-table-row-label").html("&nbsp;("+a.top_customers_other_sum+")"),s(".psupsellmaster-stats-table-top-customers .psupsellmaster-summary-table-footer .psupsellmaster-summary-table-row").eq(0).find(".psupsellmaster-stats-table-row-value").html(a.top_customers_other+"&#37;"),s(".psupsellmaster-stats-table-top-customers .psupsellmaster-summary-table-footer .psupsellmaster-summary-table-row").eq(1).find(".psupsellmaster-stats-table-row-label").html("&nbsp;("+a.sum_sales_value+")");for(var f=a.top_orders.length,n=0;n<f;n++)m=a.top_orders[n],(u=s(".psupsellmaster-stats-table-top-orders .psupsellmaster-summary-table-body .psupsellmaster-summary-table-row").eq(n)).find(".psupsellmaster-stats-table-row-label").html('<a href="'+m[4]+'" target="_blank">'+m[3]+" ("+m[1]+")</a>"),u.find(".psupsellmaster-stats-table-row-value").html(m[2]+"&#37;");s(".psupsellmaster-stats-table-top-orders .psupsellmaster-summary-table-footer .psupsellmaster-summary-table-row").eq(0).find(".psupsellmaster-stats-table-row-label").html("&nbsp;("+a.top_orders_other_sum+")"),s(".psupsellmaster-stats-table-top-orders .psupsellmaster-summary-table-footer .psupsellmaster-summary-table-row").eq(0).find(".psupsellmaster-stats-table-row-value").html(a.top_orders_other+"&#37;"),s(".psupsellmaster-stats-table-top-orders .psupsellmaster-summary-table-footer .psupsellmaster-summary-table-row").eq(1).find(".psupsellmaster-stats-table-row-label").html("&nbsp;("+a.sum_sales_value+")");for(var h=a.top_locations.length,n=0;n<h;n++){switch(m=a.top_locations[n],o=0,m[0]){case"product":o=1;break;case"checkout":o=2;break;case"purchase_receipt":o=3;break;case"widget":o=4;break;case"shortcode":o=5;break;case"block":o=6;break;case"elementor_widget":o=7;break;case"popup_add_to_cart":o=8;break;case"popup_exit_intent":o=9}!(o<1)&&((u=s(".psupsellmaster-stats-table-details-locations .psupsellmaster-summary-table-body .psupsellmaster-summary-table-row").eq(o-1)).find(".psupsellmaster-stats-table-row-label").html("&nbsp;("+m[1]+")"),u.find(".psupsellmaster-stats-table-row-value").html(m[2]+"&#37;"))}s(".psupsellmaster-stats-table-details-locations .psupsellmaster-summary-table-footer .psupsellmaster-summary-table-row").eq(0).find(".psupsellmaster-stats-table-row-label").html("&nbsp;("+a.sum_sales_value+")");for(var y=a.top_sources.length,n=0;n<y;n++){switch(m=a.top_sources[n],o=0,m[0]){case"upsells":o=1;break;case"visits":o=2;break;case"campaigns":o=3}!(o<1)&&((u=s(".psupsellmaster-stats-table-details-sources .psupsellmaster-summary-table-body .psupsellmaster-summary-table-row").eq(o-1)).find(".psupsellmaster-stats-table-row-label").html("&nbsp;("+m[1]+")"),u.find(".psupsellmaster-stats-table-row-value").html(m[2]+"&#37;"))}s(".psupsellmaster-stats-table-details-sources .psupsellmaster-summary-table-footer .psupsellmaster-summary-table-row").eq(0).find(".psupsellmaster-stats-table-row-label").html("&nbsp;("+a.sum_sales_value+")");for(var v=a.top_types.length,n=0;n<v;n++){switch(m=a.top_types[n],o=0,m[0]){case"direct":o=1;break;case"indirect":o=2;break;case"unknown":o=3}!(o<1)&&((u=s(".psupsellmaster-stats-table-details-types .psupsellmaster-summary-table-body .psupsellmaster-summary-table-row").eq(o-1)).find(".psupsellmaster-stats-table-row-label").html("&nbsp;("+m[1]+")"),u.find(".psupsellmaster-stats-table-row-value").html(m[2]+"&#37;"))}s(".psupsellmaster-stats-table-details-types .psupsellmaster-summary-table-footer .psupsellmaster-summary-table-row").eq(0).find(".psupsellmaster-stats-table-row-label").html("&nbsp;("+a.sum_sales_value+")");for(var w=a.top_views.length,n=0;n<w;n++){switch(m=a.top_views[n],o=0,m[0]){case"carousel":o=1;break;case"list":o=2;break;case"unknown":o=3}!(o<1)&&((u=s(".psupsellmaster-stats-table-details-views .psupsellmaster-summary-table-body .psupsellmaster-summary-table-row").eq(o-1)).find(".psupsellmaster-stats-table-row-label").html("&nbsp;("+m[1]+")"),u.find(".psupsellmaster-stats-table-row-value").html(m[2]+"&#37;"))}s(".psupsellmaster-stats-table-details-views .psupsellmaster-summary-table-footer .psupsellmaster-summary-table-row").eq(0).find(".psupsellmaster-stats-table-row-label").html("&nbsp;("+a.sum_sales_value+")")}).DataTable(a)},startTooltips:function s(){e.functions.attachTooltips()}}}).functions.init()}(jQuery);