!function(t){var s;(s={attributes:{},events:{onClickButton:function s(e){t(this).closest(".psupsellmaster-wizard-form").find(".psupsellmaster-backdrop-spinner").show()},onDocumentReady:function t(){s.functions.startPikadayFields(),s.functions.checkStatuses()},onSubmitForm:function s(e){e.preventDefault();var a=t(this),n={action:"psupsellmaster_ajax_save_wizard",nonce:PsUpsellmaster.attributes.ajax.nonce,data:a.serialize()},i=a.find(".psupsellmaster-backdrop-spinner");i.show(),t.ajax({url:PsUpsellmaster.attributes.ajax.url,type:"POST",dataType:"JSON",data:n,success:function(t){t.redirect?window.location=t.redirect:i.hide()},error:function(t,s,e){i.hide()},complete:function(t,s){}})}},functions:{checkStatuses:function e(){var a=t(".psupsellmaster-wizard-step.psupsellmaster-step-summary");a.length&&a.find(".psupsellmaster-step-body").find('.psupsellmaster-item[data-status="pending"]').length&&s.functions.getStatuses()},getStatuses:function e(){var a=t(".psupsellmaster-step-body"),n={action:"psupsellmaster_ajax_get_setup_wizard_statuses",nonce:PsUpsellmaster.attributes.ajax.nonce};t.ajax({url:PsUpsellmaster.attributes.ajax.url,type:"post",dataType:"json",data:n}).done(function(t){if(t.success&&t.statuses&&t.statuses.scores){var e=a.find('.psupsellmaster-item[data-key="scores"]');t.statuses.scores.html&&e.html(t.statuses.scores.html),t.statuses.scores.plain&&e.attr("data-status",t.statuses.scores.plain),s.functions.setButtonStartUpselling()}setTimeout(function(){s.functions.checkStatuses()},5e3)})},init:function t(){s.functions.registerEvents()},registerEvents:function e(){t(s.events.onDocumentReady),t(document).on("submit",".psupsellmaster-wizard .psupsellmaster-wizard-form",s.events.onSubmitForm),t(document).on("click",".psupsellmaster-wizard .psupsellmaster-step-footer .psupsellmaster-button-link",s.events.onClickButton)},setButtonStartUpselling:function s(){var e=t(".psupsellmaster-step-body"),a=t(".psupsellmaster-step-footer").find(".psupsellmaster-button-save");e.find('.psupsellmaster-item[data-status="error"]').length?a.prop("disabled",!0):a.prop("disabled",!1)},startPikadayFields:function e(){t(".psupsellmaster-field-pikaday").each(function(){var e;e=t(this),s.functions.startPikadayField(e)})},startPikadayField:function t(s){var e;e={field:s.get(0),format:"YYYY/MM/DD"},new Pikaday(e)}}}).functions.init()}(jQuery);