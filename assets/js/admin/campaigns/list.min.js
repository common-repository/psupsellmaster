!function(t){var a;(a={attributes:{},events:{onChangeBulkActions:function e(s){var n=t(this),l=n.val(),i=n.closest(".psupsellmaster-datatable-wrapper").find(".psupsellmaster-btn-apply-bulk-action");if(!["activate","deactivate","duplicate","delete"].includes(l))return a.functions.resetBulkActions(),!1;i.prop("disabled",!1),i.removeClass("disabled")},onChangeCheckRow:function a(e){var s=t(this).closest(".psupsellmaster-datatable"),n=s.find(".psupsellmaster-datatable-row").find(".psupsellmaster-check-row"),l=n.filter(":checked");s.find(".psupsellmaster-check-rows").prop("checked",l.length===n.length)},onChangeCheckRows:function a(e){var s=t(this);s.closest(".psupsellmaster-datatable").find(".psupsellmaster-datatable-row").find(".psupsellmaster-check-row").prop("checked",s.prop("checked"))},onChartJsScalesXTicksCallback:function a(e,s,n){var l=this.getLabelForValue(e)||"";return t("<textarea/>").html(l).text()},onChartJsScalesAmountTicksCallback:function e(s,n,l){var i=a.data.texts.currency_symbol;return i=t("<textarea/>").html(i).text(),i+=s.toLocaleString()},onChartJsSort:function t(){return -1},onChartJsTooltipLabel:function e(s){var n="";return"earnings"===s.dataset.yAxisID&&(n=a.data.texts.currency_symbol),n=`${s.dataset.label}: ${n}${s.raw}`,n=t("<textarea/>").html(n).text()},onChartJsTooltipTitle:function a(e){var s=(e[0]||{}).label;return t("<textarea/>").html(s).text()},onClickBtnApplyBulkAction:function e(s){var n=t(this).closest(".psupsellmaster-datatable-wrapper"),l=n.find(".psupsellmaster-field-bulk-actions").val();if(!["activate","deactivate","duplicate","delete"].includes(l))return!1;var i=n.find(".psupsellmaster-datatable-row").find(".psupsellmaster-check-row:checked");if(0===i.length)return a.functions.resetBulkActions(),alert(a.data.texts.bulk_actions_empty),!1;var r=i.map(function(){return t(this).closest(".psupsellmaster-datatable-row").find(".psupsellmaster-hidden-campaign-id").val()}).get();if("activate"===l)a.functions.setCampaignsStatus(r,"active");else if("deactivate"===l)a.functions.setCampaignsStatus(r,"inactive");else if("duplicate"===l)a.functions.duplicateCampaigns(r);else if("delete"===l){if(!confirm(a.data.texts.bulk_actions_delete_confirm))return a.functions.resetBulkActions(),!1;a.functions.deleteCampaigns(r)}},onClickBtnApplyFilters:function t(e){a.functions.applyFilters()},onClickBtnRefreshDatetimeLeft:function a(e){var s=t(this),n=s.closest(".psupsellmaster-datatable-row"),l=n.find(".psupsellmaster-hidden-campaign-id").val(),i={action:"psupsellmaster_ajax_get_campaign_datetime_left",nonce:PsUpsellmaster.attributes.ajax.nonce,id:l};s.addClass("psupsellmaster-rotate"),t.ajax({type:"post",url:PsUpsellmaster.attributes.ajax.url,data:i,beforeSend:function(t){},success:function(t){"html"in t&&n.find(".psupsellmaster-datetime-left").html(t.html)},error:function(t,a,e){},complete:function(t,a){}})},onClickBtnResetFilters:function t(e){a.functions.resetFilters()},onClickBtnToggleFilters:function a(){t(this).closest(".psupsellmaster-section").find(".psupsellmaster-filters-toggle").toggle()},onClickRowActionDuplicate:function e(s){s.preventDefault();var n=t(this).closest(".psupsellmaster-datatable-row").find(".psupsellmaster-hidden-campaign-id").val();a.functions.duplicateCampaigns(Array(n))},onClickRowActionSetStatus:function e(s){s.preventDefault();var n=t(this),l=n.closest(".psupsellmaster-datatable-row").find(".psupsellmaster-hidden-campaign-id").val(),i=n.attr("data-status");a.functions.setCampaignsStatus(Array(l),i)},onDataTableAjaxData:function e(s,n){return s=t.extend(!0,s,{action:a.actions.main,nonce:PsUpsellmaster.attributes.ajax.nonce,filters:a.settings.datatables.custom.main.ajax.data.filters})},onDataTableAjaxDataSrc:function t(a){return a.datatables&&a.datatables.main?(a.draw=a.datatables.main.draw||0,a.recordsTotal=a.datatables.main.total||0,a.recordsFiltered=a.datatables.main.filtered||0,a.datatables.main.data||a.datatables.main):a},onDataTableCreatedCell:function a(e){t(e).addClass("psupsellmaster-datatable-col")},onDataTableCreatedRow:function a(e){t(e).addClass("psupsellmaster-datatable-row")},onDataTableDrawCallback:function e(){a.functions.resetBulkActions(),t(".psupsellmaster-check-rows").prop("checked",!1)},onDataTableExportFormatBody:function a(e,s,n,l){var i=t("<div>").html(e);i.find(".psupsellmaster-ignore-on-export").remove();var r=i.text();return(r=r.replace(/^\s*\n/gm,"")).trim()},onDataTableInitComplete:function e(s){t(".psupsellmaster-datatable-wrapper .buttons-copy").html('<i class="fa fa-copy"></i>&nbsp;'+a.data.texts.datatable_btn_copy),t(".psupsellmaster-datatable-wrapper .buttons-csv").html('<i class="fa fa-file-csv"></i>&nbsp;'+a.data.texts.datatable_btn_csv),t(".psupsellmaster-datatable-wrapper .buttons-excel").html('<i class="fa fa-file-excel"></i>&nbsp;'+a.data.texts.datatable_btn_excel),t(".psupsellmaster-datatable-wrapper .buttons-print").html('<i class="fa fa-print"></i>&nbsp;'+a.data.texts.datatable_btn_print);var n=t(".psupsellmaster-datatable").closest(".psupsellmaster-datatable-wrapper"),l=n.find(".psupsellmaster-bulk-actions").detach();n.find(".dt-buttons").prepend(l),l.show(),t(document).trigger("psupsellmaster-datatable-init-complete")},onDataTableUpdate:function t(e,s,n,l){var i=n;i&&(a.functions.startCharts(i),a.functions.updateKpis(i))},onDocumentReady:function t(){a.functions.startPikadayFields(),a.functions.startDataTables()}},functions:{applyFilters:function t(){var e=a.functions.getFilters();a.settings.datatables.custom.main.ajax.data.filters=e,a.functions.reloadDataTable()},clearFilters:function a(){t(".psupsellmaster-filters .psupsellmaster-field").val(null).trigger("change")},deleteCampaigns:function e(s){var n={action:"psupsellmaster_ajax_delete_campaigns",nonce:PsUpsellmaster.attributes.ajax.nonce,ids:s};t.ajax({type:"post",url:PsUpsellmaster.attributes.ajax.url,data:n,beforeSend:function(t){},success:function(t){},error:function(t,a,e){},complete:function(t,e){a.functions.reloadDataTable()}})},resetBulkActions:function a(){var e=t(".psupsellmaster-datatable-wrapper");e.find(".psupsellmaster-field-bulk-actions").val("");var s=e.find(".psupsellmaster-btn-apply-bulk-action");s.prop("disabled",!0),s.addClass("disabled")},duplicateCampaigns:function e(s){var n={action:"psupsellmaster_ajax_duplicate_campaigns",nonce:PsUpsellmaster.attributes.ajax.nonce,ids:s};t.ajax({type:"post",url:PsUpsellmaster.attributes.ajax.url,data:n,beforeSend:function(t){},success:function(t){t.redirect&&1===s.length&&window.open(t.redirect,"_blank")},error:function(t,a,e){},complete:function(t,e){a.functions.reloadDataTable()}})},getFilters:function a(){var e={authors:{},campaign_date:{start:[],end:[]},carts:{gross_earnings:{min:[],max:[]},tax:{min:[],max:[]},discount:{min:[],max:[]},net_earnings:{min:[],max:[]},orders_qty:{min:[],max:[]},aov:{min:[],max:[]}},events:{add_to_cart:{min:[],max:[]},click:{min:[],max:[]},impression:{min:[],max:[]}},locations:[],products:{},status:[],taxonomies:{},weekdays:[]},s=t(".psupsellmaster-filters");return e.authors=s.find(".psupsellmaster-field-authors").val()||[],e.campaign_date.start=s.find(".psupsellmaster-field-campaign-date-start").val()||[],e.campaign_date.end=s.find(".psupsellmaster-field-campaign-date-end").val()||[],e.carts.gross_earnings.min=s.find(".psupsellmaster-field-carts-gross-earnings-min").val()||[],e.carts.gross_earnings.max=s.find(".psupsellmaster-field-carts-gross-earnings-max").val()||[],e.carts.tax.min=s.find(".psupsellmaster-field-carts-tax-min").val()||[],e.carts.tax.max=s.find(".psupsellmaster-field-carts-tax-max").val()||[],e.carts.discount.min=s.find(".psupsellmaster-field-carts-discount-min").val()||[],e.carts.discount.max=s.find(".psupsellmaster-field-carts-discount-max").val()||[],e.carts.net_earnings.min=s.find(".psupsellmaster-field-carts-net-earnings-min").val()||[],e.carts.net_earnings.max=s.find(".psupsellmaster-field-carts-net-earnings-max").val()||[],e.carts.orders_qty.min=s.find(".psupsellmaster-field-carts-orders-qty-min").val()||[],e.carts.orders_qty.max=s.find(".psupsellmaster-field-carts-orders-qty-max").val()||[],e.carts.aov.min=s.find(".psupsellmaster-field-carts-aov-min").val()||[],e.carts.aov.max=s.find(".psupsellmaster-field-carts-aov-max").val()||[],e.events.impression.min=s.find(".psupsellmaster-field-events-impression-min").val()||[],e.events.impression.max=s.find(".psupsellmaster-field-events-impression-max").val()||[],e.events.click.min=s.find(".psupsellmaster-field-events-click-min").val()||[],e.events.click.max=s.find(".psupsellmaster-field-events-click-max").val()||[],e.events.add_to_cart.min=s.find(".psupsellmaster-field-events-add-to-cart-min").val()||[],e.events.add_to_cart.max=s.find(".psupsellmaster-field-events-add-to-cart-max").val()||[],e.locations=s.find(".psupsellmaster-field-locations").val()||[],e.products=s.find(".psupsellmaster-field-products").val()||[],e.status=s.find(".psupsellmaster-field-status").val()||[],e.weekdays=s.find(".psupsellmaster-field-weekdays").val()||[],e},init:function t(){a.functions.registerAttributes(),a.functions.registerEvents()},registerAttributes:function e(){"undefined"!=typeof psupsellmaster_admin_data_campaigns_list&&(a.data=psupsellmaster_admin_data_campaigns_list),PsUpsellmaster.attributes.popups=PsUpsellmaster.attributes.popups||{},a.actions={main:"psupsellmaster_ajax_get_campaigns_list_table"},a.settings={chartjs:{default:{},custom:{main:{}}},datatables:{default:{},custom:{main:{}}}},a.settings.chartjs.default={data:{datasets:[{backgroundColor:"rgb(24, 128, 56)",borderColor:"rgb(24, 128, 56)",data:[],label:"",order:1,type:"line",yAxisID:"earnings"},{backgroundColor:"rgb(217, 48, 37)",borderColor:"rgb(217, 48, 37)",data:[],label:"",order:3,type:"line",yAxisID:"orders"},{backgroundColor:"rgb(26, 115, 232)",borderColor:"rgb(26, 115, 232)",data:[],label:"",order:2,type:"line",yAxisID:"carts"},],labels:[]},options:{interaction:{intersect:!1,mode:"index"},maintainAspectRatio:!1,plugins:{legend:{labels:{sort:a.events.onChartJsSort}},tooltip:{callbacks:{label:a.events.onChartJsTooltipLabel,title:a.events.onChartJsTooltipTitle},itemSort:a.events.onChartJsSort}},responsive:!0,scales:{x:{ticks:{callback:a.events.onChartJsScalesXTicksCallback}},earnings:{position:"left",ticks:{callback:a.events.onChartJsScalesAmountTicksCallback}},orders:{display:!1,position:"right",ticks:{precision:0}},carts:{position:"right",ticks:{precision:0}}}}},a.settings.chartjs.custom.main=t.extend(!0,{},a.settings.chartjs.default),a.settings.datatables.default={ajax:{data:a.events.onDataTableAjaxData,dataSrc:a.events.onDataTableAjaxDataSrc,type:"POST",url:PsUpsellmaster.attributes.ajax.url},buttons:[{className:"button",extend:"copyHtml5",exportOptions:{format:{body:a.events.onDataTableExportFormatBody}}},{className:"button",extend:"print",exportOptions:{format:{body:a.events.onDataTableExportFormatBody}}},{className:"button",extend:"csvHtml5",exportOptions:{format:{body:a.events.onDataTableExportFormatBody}}},{className:"button",extend:"excelHtml5",exportOptions:{format:{body:a.events.onDataTableExportFormatBody}}},],createdRow:a.events.onDataTableCreatedRow,displayLength:10,dom:"Bliptip",drawCallback:a.events.onDataTableDrawCallback,filter:!0,initComplete:a.events.onDataTableInitComplete,oLanguage:{sLengthMenu:a.data.texts.datatable_length},order:[[3,"asc"]],pageLength:10,lengthMenu:[[10,25,50,100,250,1e3],[10,25,50,100,250,1e3],],paginate:!0,pagingType:"full_numbers",serverSide:!0,responsive:{details:{target:".psupsellmaster-toggle-details",type:"column"}}},PsUpsellmaster.attributes.plugin.is_pro?a.settings.datatables.default.columnDefs=[{className:"dt-body-center",targets:[0]},{className:"dt-body-left",targets:[1,2,3,6]},{className:"dt-body-right",targets:[4,5,7,8,9,10,11,12,13]},{orderable:!1,targets:[0,6]},{createdCell:a.events.onDataTableCreatedCell,searchable:!1,targets:"_all"},]:a.settings.datatables.default.columnDefs=[{className:"dt-body-center",targets:[0]},{className:"dt-body-left",targets:[1,2,3,5]},{className:"dt-body-right",targets:[4,6,7,8,9,10,11]},{orderable:!1,targets:[0,5]},{createdCell:a.events.onDataTableCreatedCell,searchable:!1,targets:"_all"},],a.settings.datatables.custom.main=t.extend(!0,{},a.settings.datatables.default),a.instances={charts:{main:null},datatables:{main:null}}},registerEvents:function e(){t(a.events.onDocumentReady),t(document).on("xhr.dt","#psupsellmaster-datatable-campaigns",a.events.onDataTableUpdate),t(document).on("click","#psupsellmaster-btn-toggle-filters",a.events.onClickBtnToggleFilters),t(document).on("click","#psupsellmaster-btn-apply-filters",a.events.onClickBtnApplyFilters),t(document).on("click","#psupsellmaster-btn-reset-filters",a.events.onClickBtnResetFilters),t(document).on("click",".psupsellmaster-btn-apply-bulk-action",a.events.onClickBtnApplyBulkAction),t(document).on("change",".psupsellmaster-field-bulk-actions",a.events.onChangeBulkActions),t(document).on("click",".psupsellmaster-row-actions .psupsellmaster-duplicate",a.events.onClickRowActionDuplicate),t(document).on("click",".psupsellmaster-row-actions .psupsellmaster-set-status",a.events.onClickRowActionSetStatus),t(document).on("click",".psupsellmaster-check-rows",a.events.onChangeCheckRows),t(document).on("click",".psupsellmaster-check-row",a.events.onChangeCheckRow),t(document).on("click",".psupsellmaster-btn-refresh-datetime-left",a.events.onClickBtnRefreshDatetimeLeft)},reloadDataTable:function t(){a.instances.datatables.main.ajax.reload()},resetFilters:function t(){a.functions.clearFilters(),a.settings.datatables.custom.main.ajax.data.filters={},a.functions.reloadDataTable()},setCampaignsStatus:function e(s,n){var l={action:"psupsellmaster_ajax_set_campaigns_status",nonce:PsUpsellmaster.attributes.ajax.nonce,ids:s,status:n};t.ajax({type:"post",url:PsUpsellmaster.attributes.ajax.url,data:l,beforeSend:function(t){},success:function(t){},error:function(t,a,e){},complete:function(t,e){a.functions.reloadDataTable()}})},startCharts:function t(e){if(a.instances.charts.main)try{a.instances.charts.main.destroy()}catch(s){}var n=0;a.settings.chartjs.custom.main.data.datasets[0].data=[],a.settings.chartjs.custom.main.data.datasets[1].data=[],a.settings.chartjs.custom.main.data.datasets[2].data=[],a.settings.chartjs.custom.main.data.labels=[];for(var n=e.charts.main.items.length,l=0;l<n;l++)a.settings.chartjs.custom.main.data.datasets[0].data.push(e.charts.main.items[l].earnings),a.settings.chartjs.custom.main.data.datasets[1].data.push(e.charts.main.items[l].carts),a.settings.chartjs.custom.main.data.datasets[2].data.push(e.charts.main.items[l].orders),a.settings.chartjs.custom.main.data.labels.push(e.charts.main.items[l].label);for(var n=e.charts.main.legends.length,l=0;l<n;l++)a.settings.chartjs.custom.main.data.datasets[0].label=e.charts.main.legends[l].earnings,a.settings.chartjs.custom.main.data.datasets[1].label=e.charts.main.legends[l].carts,a.settings.chartjs.custom.main.data.datasets[2].label=e.charts.main.legends[l].orders;a.instances.charts.main=new Chart(document.getElementById("psupsellmaster-campaigns-chart-main"),a.settings.chartjs.custom.main)},startDataTables:function e(){var s=t("#psupsellmaster-datatable-campaigns");a.instances.datatables.main=s.DataTable(a.settings.datatables.custom.main)},startPikadayFields:function e(){t(".psupsellmaster-field-pikaday").each(function(){var e;e=t(this),a.functions.startPikadayField(e)})},startPikadayField:function t(a){var e;e={field:a.get(0),format:"YYYY/MM/DD"},new Pikaday(e)},updateKpis:function a(e){t(".psupsellmaster-kpis").html(e.kpis)}}}).functions.init()}(jQuery);