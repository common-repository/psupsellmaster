!function(t){var a;(a={attributes:{},events:{onClickBtnAddToCart:function e(o){if(!(!a.attributes.open_on_add||t("body").hasClass("psupsellmaster-modal-open"))&&!0!==PsUpsellmaster.attributes.popups.lock){var s=t(this),n={},d={};if(PsUpsellmaster.attributes.integrations.woo){if(d.id=s.data("product_id"),"product"===PsUpsellmaster.attributes.current.page&&d.id===PsUpsellmaster.attributes.current.page)return;d.variations=Array(d.id),n.products=Array(d)}else if(PsUpsellmaster.attributes.integrations.edd){d.id=s.data("download-id"),d.variations=[];var i=s.parents("form").last();"yes"===s.data("variable-price")&&(i.find(".edd_price_option_"+d.id+'[type="hidden"]').length>0?d.variations[0]=t(".edd_price_option_"+d.id,i).val():(d.variations=[],i.find(".edd_price_option_"+d.id+":checked",i).each(function(a){d.variations[a]=t(this).val()}))),n.products=Array(d)}a.functions.get(n)}},onDocumentReady:function t(){a.attributes.open_on_load&&!0!==PsUpsellmaster.attributes.popups.lock&&a.functions.open("open_on_load")}},functions:{get:function e(o){var s=t("#psupsellmaster-modal-add-to-cart"),n=s.find(".psupsellmaster-modal-header").find(".psupsellmaster-modal-title"),d=s.find(".psupsellmaster-modal-body").find(".psupsellmaster-modal-ajax-container");if(n.hide(),d.html(""),o.action="psupsellmaster_ajax_get_popup_add_to_cart",o.nonce=PsUpsellmaster.attributes.ajax.nonce,!0===PsUpsellmaster.attributes.popups.lock)return!1;PsUpsellmaster.attributes.popups.lock=!0,t.ajax({url:PsUpsellmaster.attributes.ajax.url,type:"post",dataType:"json",data:o}).done(function(t){void 0!==t.data&&t.data.content&&0!==t.data.content.length&&(d.html(t.data.content),PsUpsellmaster.attributes.integrations.edd&&d.find(".edd-add-to-cart:not(.edd-no-js)").addClass("edd-has-js"),t.data.title&&0!==t.data.title.length&&(n.html(t.data.title),n.show()),a.functions.open("open_on_add"))}).always(function(){PsUpsellmaster.attributes.popups.lock=!1})},init:function t(){a.functions.registerAttributes(),a.functions.registerEvents()},open:function a(e){var o=t("#psupsellmaster-modal-add-to-cart"),s=o.find(".psupsellmaster-modal-body").find(".psupsellmaster-modal-ajax-container"),n=s.find(".psupsellmaster-added-container");if("open_on_load"===e){if(e!==n.attr("data-context"))return;n.removeAttr("data-context")}PsUpsellmaster.attributes.integrations.edd&&s.find(".edd-add-to-cart:not(.edd-no-js)").addClass("edd-has-js"),"carousel"===s.find(".psupsellmaster.psupsellmaster-product").data("display-type")?o.addClass("psupsellmaster-type-carousel"):o.removeClass("psupsellmaster-type-carousel"),PsUpsellmaster.functions.openModal(o),"object"==typeof PsUpsellmaster.attributes.products&&PsUpsellmaster.attributes.products.functions.start(),"object"==typeof PsUpsellmaster.attributes.productsCarousel&&PsUpsellmaster.attributes.productsCarousel.functions.start()},registerAttributes:function t(){"undefined"!=typeof psupsellmaster_data_popup_add_to_cart&&(a.attributes=psupsellmaster_data_popup_add_to_cart),PsUpsellmaster.attributes.popups=PsUpsellmaster.attributes.popups||{},PsUpsellmaster.attributes.popups.addToCart=a,PsUpsellmaster.attributes.popups.lock=!1},registerEvents:function e(){t(a.events.onDocumentReady),t("body").on("click",".edd-add-to-cart",a.events.onClickBtnAddToCart),t("body").on("click",".add_to_cart_button.product_type_simple",a.events.onClickBtnAddToCart),t("body").on("click",".add_to_cart_button.ajax_add_to_cart",a.events.onClickBtnAddToCart)}}}).functions.init()}(jQuery);